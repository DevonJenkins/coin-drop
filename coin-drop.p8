pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
function _init()
	game = {
		state = "menu",
		level = 1,		
	}
	bucket = {
		movement = "false",
		x = 63,
		y = 100,
		fx = false,
		fy = false,
		sprite = 1,
		speed = 3,
		lives = 3,
		score = 0 
			}
	
	coin = {
		x = flr(rnd(2,124)),
		y = 4,
		fx = false,
		fy = false,
		sprite = 2,
		speed = 3,
		-- no lives
		rst = false, --coin reset
		fall = false
	}
end

function _update()
	if game.state == "game"
	then
		bucket_movement()
		bucket_edge_detection()
	
		coin_fall()
		coin_collision()
	end
	
	if coin.y >= 120
	then 
	coin.rst = true			
	bucket.lives -= 1
	end
	
		
end

function _draw()
	cls(5)
	if game.state == "menu"
	and 
	btn(❎)
	then 
		bucket.movement = true
		game.state = "game"
	 coin.fall = true
	 coin.rst = true	 	 
	end
	
	if game.state == "game" then
		cls(1)
		map(0)
		--cls(12) for blue
		if coin.rst == false then
		 spr(coin.sprite, coin.x, coin.y)
		else
			coin.y=4
			coin.x=flr(rnd(125))
			coin.rst=false	
		end
	
		print("score: "..bucket.score)
		print("lives: "..bucket.lives)
		spr(bucket.sprite, bucket.x, bucket.y)
		
		if 
			bucket.lives < 0 
		then 
			game.state = "gameover"			
			bucket.lives = 3
			bucket.score = 0		
		end
	elseif game.state == "menu"
	then	 
	 print("press x to start game",25,63)	
 elseif game.state == "gameover"
 then		
 		cls() 
			print("game over",50,63)
			print("press x to restart",40,70)
 		if btnp(❎) 
 		then
 			game.state="game"
 		end
 end
end
-->8
-- helper functions 
function bucket_movement()
	if bucket.movement == true	
	then
		if 
			btn(⬅️) then bucket.x -= bucket.speed
		elseif 
			btn(➡️) then bucket.x += bucket.speed
		end
	end
end

function bucket_edge_detection()	
	if bucket.x <= 0 then bucket.x = 0
	elseif bucket.x >= 120 then bucket.x = 120
	end
end

function coin_fall()
	if coin.fall == true
	then
	coin.y += coin.speed
	end
end

function coin_collision()
	if 
	coin.x >= bucket.x - 4
	and
	coin.x <= bucket.x + 4
	and
	coin.y >= bucket.y - 4
	and 
	coin.y <= bucket.y +4 
	
	then 
	 coin.rst = true
	 bucket.score += 1
	end
end

-->8
--[[ psuedocode
--while moving, make sound
--make sound when i catch a coin
--how to build a one up

				- create a heart sprite
				  or use "♥" char
				- every time a coin drops
						pick a random number on 
						a range. the range may 
						change depending on the 
						level. when a specific 
						number in that range is 
						selected, drop a heart sprite.
				- should heart speed increase
						at same rate as coin speed? 
				
--]]
__gfx__
000000000666666000066000cccccccccccccccccccccccccccccccccccccccccccccccc00000000000000000000000000000000000000000000000000000000
000000006a7799a6006a9600ccccccccc7cccccccccccccccccccccccccccccccccccccc00000000000000000000000000000000000000000000000000000000
0070070067a9aa9600699600cccccccc7c7ccc7cccccccccccccc77cccccc77cccc7cccc00000000000000000000000000000000000000000000000000000000
00077000d666666d0067a600ccccccccccccccccc7cccc77c77cc77ccccccc77ccc77ccc00000000000000000000000000000000000000000000000000000000
0007700007d7ddd000679600cccccccccccccccc777ccc76c77c777ccccccc77cc77777700000000000000000000000000000000000000000000000000000000
0070070006d7ddd0006a9600cccccccccccc77cc77777777cc77777777ccccccc7c777cc00000000000000000000000000000000000000000000000000000000
00000000067d7dd000699600ccccccccccccc77c6777c7ccc777c7c7c77cc7cccccccccc00000000000000000000000000000000000000000000000000000000
000000000766666000066000cccccccccccccccccccccccccccccccc77c777cccccccccc00000000000000000000000000000000000000000000000000000000
__gff__
0000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0303030403030304030304030303030303030304030303040303040303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030304030304040303030308030303030303040303040403030303080303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0304030303030303030404030303030303040303030303030304040303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0305030303030303030706070303030303050303030303030307060703030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030408030303030303030303030303030304080303030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303060708070303030303030303030303030607080703030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030407030303030303030303030303030304070303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030704030303030303040303030303030307040303030303030403030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303070404030304030303030303030303030704040303040303030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030403030304030304030303030303030304030303040303040303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030304030304040303030308030303030303040303040403030303080303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0304030303030303030404030303030303040303030303030304040303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0305030303030303030706070303030303050303030303030307060703030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030408030303030303030303030303030304080303030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303060708070303030303030303030303030607080703030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030407030303030303030303030303030304070303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030704030303030303040303030303030307040303030303030403030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303070404030304030303030303030303030704040303040303030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
